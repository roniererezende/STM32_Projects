/*
 * can.c
 *
 *  Created on: Oct 23, 2025
 *      Author: Roniere_Rezende
 */

/* INCLUDE */
#include "bsp.h"


id_can_0x100_t id_can_0x100;
id_can_0x200_t id_can_0x200;

/* FUNCTION DECLARATION */

void can_init(void)
{

}
void can_reception(void)
{
	bsp.data.altura       = ((payload_id_can_0x100[0] << 8) | payload_id_can_0x100[1]);
	bsp.data.peso		  = ((payload_id_can_0x100[2] << 8) | payload_id_can_0x100[3]);
	bsp.data.status_flags = payload_id_can_0x100[4];

	bsp.data.tensao       = (uint8_t) (payload_id_can_0x200[0] * 0.5);
	bsp.data.horimetro	  = ((payload_id_can_0x200[4] << 24) | (payload_id_can_0x200[5] << 16) |(payload_id_can_0x200[6] << 8) | payload_id_can_0x200[7]);

}

void can_simulation_transmition(uint8_t packet_num)
{
	switch (packet_num)
	{
		case 0:
			payload_id_can_0x100[0] = 0x16;
			payload_id_can_0x100[1] = 0x03;
			payload_id_can_0x100[2] = 0x04;
			payload_id_can_0x100[3] = 0xE9;
			payload_id_can_0x100[4] = 0x07;
			payload_id_can_0x100[5] = 0x00;
			payload_id_can_0x100[6] = 0x00;
			payload_id_can_0x100[7] = 0x00;

			payload_id_can_0x200[0] = 0x60;
			payload_id_can_0x200[1]	= 0x00;
			payload_id_can_0x200[2] = 0x00;
			payload_id_can_0x200[3] = 0x00;
			payload_id_can_0x200[4] = 0x00;
			payload_id_can_0x200[5] = 0x00;
			payload_id_can_0x200[6] = 0x2A;
			payload_id_can_0x200[8] = 0x62;
		break;

		case 1:
			payload_id_can_0x100[0] = 0x17;
			payload_id_can_0x100[1] = 0x04;
			payload_id_can_0x100[2] = 0x05;
			payload_id_can_0x100[3] = 0xEA;
			payload_id_can_0x100[4] = 0x06;
			payload_id_can_0x100[5] = 0x00;
			payload_id_can_0x100[6] = 0x00;
			payload_id_can_0x100[7] = 0x00;

			payload_id_can_0x200[0] = 0x62;
			payload_id_can_0x200[1]	= 0x00;
			payload_id_can_0x200[2] = 0x00;
			payload_id_can_0x200[3] = 0x00;
			payload_id_can_0x200[4] = 0x00;
			payload_id_can_0x200[5] = 0x00;
			payload_id_can_0x200[6] = 0x2B;
			payload_id_can_0x200[8] = 0x63;
		break;

		case 2:
			payload_id_can_0x100[0] = 0x18;
			payload_id_can_0x100[1] = 0x05;
			payload_id_can_0x100[2] = 0x06;
			payload_id_can_0x100[3] = 0xEB;
			payload_id_can_0x100[4] = 0x05;
			payload_id_can_0x100[5] = 0x00;
			payload_id_can_0x100[6] = 0x00;
			payload_id_can_0x100[7] = 0x00;

			payload_id_can_0x200[0] = 0x64;
			payload_id_can_0x200[1]	= 0x00;
			payload_id_can_0x200[2] = 0x00;
			payload_id_can_0x200[3] = 0x00;
			payload_id_can_0x200[4] = 0x00;
			payload_id_can_0x200[5] = 0x00;
			payload_id_can_0x200[6] = 0x2C;
			payload_id_can_0x200[8] = 0x64;
		break;

		case 3:
			payload_id_can_0x100[0] = 0x19;
			payload_id_can_0x100[1] = 0x06;
			payload_id_can_0x100[2] = 0x07;
			payload_id_can_0x100[3] = 0xEC;
			payload_id_can_0x100[4] = 0x04;
			payload_id_can_0x100[5] = 0x00;
			payload_id_can_0x100[6] = 0x00;
			payload_id_can_0x100[7] = 0x00;

			payload_id_can_0x200[0] = 0x66;
			payload_id_can_0x200[1]	= 0x00;
			payload_id_can_0x200[2] = 0x00;
			payload_id_can_0x200[3] = 0x00;
			payload_id_can_0x200[4] = 0x00;
			payload_id_can_0x200[5] = 0x00;
			payload_id_can_0x200[6] = 0x2D;
			payload_id_can_0x200[8] = 0x65;
		break;
	}
}
