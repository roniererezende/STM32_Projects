/*
 * bsp.c
 *
 *  Created on: Oct 23, 2025
 *      Author: Roniere_Rezende
 */

/* INCLUDES */
#include "bsp.h"

/* VARIABLES */
bsp_s bsp;

/* FUNCTION DECLARATION */
void BSP_init(void)
{
	// Habilita a contador do timer 1 realiza a interrupção a 1ms. A cada 2 segundos ele habilitará uma flag que permitirá o recebimento das mensagem da CAN
	HAL_TIM_Base_Start(&htim1);

	// Habilita a interrupção do Timer 1
	HAL_TIM_Base_Start_IT(&htim1);

	bsp.led.status = false;
}

void bsp_main(void)
{
	switch (bsp.state)
	{
		case init:
			BSP_init();
			bsp.state = run;
		break;

		case idle:
		break;

		case run:
			can_receive();
			bsp.state = idle;
		break;

		case receive_ready:
			led_blink();
			break;
	}
}
